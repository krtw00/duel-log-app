# 認証フロー テストケース

## 概要

ユーザー認証に関するテストケース一覧。
ログイン、ログアウト、新規登録、セッション管理をカバー。

---

## TC-AUTH-001: 正常ログイン

### 目的
有効な認証情報でログインできることを確認

### 前提条件
- テストユーザーが存在する（email: test@example.com）
- ログアウト状態である

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ログインページ（/login）を開く | ログインフォームが表示される |
| 2 | メールアドレスを入力 | 入力値が表示される |
| 3 | パスワードを入力 | マスクされて表示される |
| 4 | ログインボタンをクリック | ダッシュボード（/dashboard）にリダイレクト |
| 5 | ヘッダーを確認 | ユーザー名が表示される |

### agent-browser コマンド

```bash
agent-browser open "http://localhost:5173/login"
agent-browser snapshot -i
agent-browser fill @email "test@example.com"
agent-browser fill @password "testpassword"
agent-browser click @login-button
agent-browser snapshot
# 期待: ダッシュボード要素が表示される
```

---

## TC-AUTH-002: 無効なパスワードでのログイン

### 目的
無効なパスワードでログインが拒否されることを確認

### 前提条件
- テストユーザーが存在する
- ログアウト状態である

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ログインページを開く | ログインフォームが表示される |
| 2 | 正しいメールアドレスを入力 | 入力値が表示される |
| 3 | 間違ったパスワードを入力 | マスクされて表示される |
| 4 | ログインボタンをクリック | エラーメッセージが表示される |
| 5 | URLを確認 | /login のまま |

### agent-browser コマンド

```bash
agent-browser open "http://localhost:5173/login"
agent-browser snapshot -i
agent-browser fill @email "test@example.com"
agent-browser fill @password "wrongpassword"
agent-browser click @login-button
agent-browser snapshot
# 期待: エラーメッセージが表示される
```

---

## TC-AUTH-003: ログアウト

### 目的
ログイン中のユーザーがログアウトできることを確認

### 前提条件
- ログイン状態である

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ダッシュボードを開く | ダッシュボードが表示される |
| 2 | ユーザーメニューをクリック | メニューが開く |
| 3 | ログアウトをクリック | ログインページにリダイレクト |
| 4 | ダッシュボードにアクセス | ログインページにリダイレクト |

---

## TC-AUTH-004: セッション有効期限

### 目的
セッションの有効期限が切れた場合の動作を確認

### 前提条件
- ログイン状態である
- セッショントークンの有効期限が切れている

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ダッシュボードを開く | ログインページにリダイレクト |
| 2 | エラーメッセージを確認 | セッション期限切れのメッセージ |

---

## TC-AUTH-005: 新規登録

### 目的
新規ユーザーがアカウントを作成できることを確認

### 前提条件
- 登録するメールアドレスが未使用

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | 登録ページ（/register）を開く | 登録フォームが表示される |
| 2 | ユーザー名を入力 | 入力値が表示される |
| 3 | メールアドレスを入力 | 入力値が表示される |
| 4 | パスワードを入力 | マスクされて表示される |
| 5 | パスワード確認を入力 | マスクされて表示される |
| 6 | 登録ボタンをクリック | 成功メッセージまたはダッシュボードへリダイレクト |

---

## TC-AUTH-006: 重複メールアドレスでの登録

### 目的
既存のメールアドレスで登録が拒否されることを確認

### 前提条件
- 登録するメールアドレスが既に使用されている

### テスト手順

| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | 登録ページを開く | 登録フォームが表示される |
| 2 | 既存のメールアドレスを入力 | 入力値が表示される |
| 3 | 他の必須項目を入力 | 入力値が表示される |
| 4 | 登録ボタンをクリック | エラーメッセージ（メールアドレス重複）が表示される |

---

## カバレッジ

| テストID | 機能 | 正常系 | 異常系 | E2E対応 |
|----------|------|--------|--------|---------|
| TC-AUTH-001 | ログイン | ✅ | - | ✅ |
| TC-AUTH-002 | ログイン | - | ✅ | ✅ |
| TC-AUTH-003 | ログアウト | ✅ | - | ✅ |
| TC-AUTH-004 | セッション | - | ✅ | ⬜ |
| TC-AUTH-005 | 新規登録 | ✅ | - | ✅ |
| TC-AUTH-006 | 新規登録 | - | ✅ | ✅ |
