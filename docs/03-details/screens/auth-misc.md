---
depends_on: [../ui.md]
tags: [screens, ui, auth, password-reset]
ai_summary: "パスワードリセット系画面の機能仕様（リセット依頼・新PW設定・OAuthコールバック）"
---

# パスワードリセット系

> Status: Active
> 最終更新: 2026-01-24

本ドキュメントは認証補助画面（パスワードリセット依頼・新パスワード設定・OAuthコールバック）をまとめて定義する。

---

## パスワードリセット依頼

### 画面概要

| 項目 | 内容 |
|------|------|
| パス | `/forgot-password` |
| 目的 | パスワードリセット用メールを送信する |
| アクセス権 | 不要 |
| レスポンシブ | 中央寄せカード |

### フォーム

| フィールド | 型 | 必須 | バリデーション |
|-----------|-----|:---:|--------------|
| メールアドレス | メール入力 | ✅ | メール形式 |

### ユーザー操作

| 操作 | トリガー | 結果 |
|------|---------|------|
| リセットメール送信 | 送信ボタン | Supabase resetPasswordForEmail呼出 |
| ログインへ戻る | リンククリック | `/login`へ遷移 |

### 状態

| 状態 | 条件 | 表示内容 |
|------|------|---------|
| 送信中 | API呼出中 | ボタンにスピナー |
| 送信完了 | 正常送信後 | 成功通知 |
| エラー | 送信失敗 | エラーメッセージ |

---

## 新パスワード設定

### 画面概要

| 項目 | 内容 |
|------|------|
| パス | `/reset-password/:token?` |
| 目的 | 新しいパスワードを設定する |
| アクセス権 | 有効なリセットトークン必須 |
| レスポンシブ | 中央寄せカード |

### 初期処理

画面表示時にSupabaseセッションを検証する。無効な場合は `/forgot-password` にリダイレクトする。

### フォーム

| フィールド | 型 | 必須 | バリデーション |
|-----------|-----|:---:|--------------|
| 新パスワード | パスワード入力（表示切替可） | ✅ | 8文字以上 |
| パスワード確認 | パスワード入力（表示切替可） | ✅ | 新パスワードと一致 |

### ユーザー操作

| 操作 | トリガー | 結果 |
|------|---------|------|
| パスワード変更 | 変更ボタン | Supabase updateUser → 全セッション無効化 → ログインへ遷移 |
| ログインへ戻る | リンククリック | `/login`へ遷移 |

### 状態

| 状態 | 条件 | 表示内容 |
|------|------|---------|
| セッション検証中 | 初期読込時 | スピナー + 「セッション確認中」 |
| セッション無効 | トークン期限切れ | `/forgot-password`へリダイレクト |
| 変更中 | API呼出中 | ボタンにスピナー |
| 変更完了 | 正常完了後 | ログインへ遷移 |

---

## OAuthコールバック

### 画面概要

| 項目 | 内容 |
|------|------|
| パス | `/auth/callback` |
| 目的 | OAuth認証後のリダイレクトを処理する |
| アクセス権 | OAuth認証フロー経由のみ |
| レスポンシブ | - |

### 処理フロー

1. Supabaseがリダイレクトを処理しセッションを確立する
2. 認証成功: ダッシュボード（`/`）へ遷移する
3. 認証失敗: ログイン（`/login`）へ遷移する

---

## 関連ドキュメント

- [../ui.md](../ui.md) - 画面一覧・共通パターン
- [login.md](./login.md) - ログイン画面
- [../flows.md](../flows.md) - 認証フロー詳細
