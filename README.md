# Duel Log App

**Duel Log App** は、遊戯王マスターデュエルの戦績を効率的に管理・分析するためのWebアプリケーションです。対戦履歴の登録から統計分析、デッキ管理まで幅広い機能を提供し、プレイヤーの戦績向上をサポートします。

---

## 🚀 主な機能

- **ダッシュボード**: ゲームモード（ランク、レート、イベント、DC）ごとの対戦履歴と各種統計情報（勝率、先行/後攻率など）を一覧表示。
- **対戦記録**: 使用デッキ、相手デッキ、勝敗、先攻/後攻、ランク/レートなど、詳細な対戦データを記録・編集・削除。
- **デッキ管理**: 自分のデッキと、対戦相手のデッキを分けて登録・管理。
- **統計分析**: デッキの分布（月間、直近）や、デッキ間の相性を円グラフや表で視覚的に分析。
- **ユーザー管理**: 安全なユーザー登録、ログイン機能。
- **プロフィール管理**: ユーザー名、メールアドレス、パスワードの変更、およびアカウントの削除機能。

---

## ⚙️ 技術スタック

| カテゴリ       | 技術                                   |
| :------------- | :------------------------------------- |
| **バックエンド**   | Python, FastAPI, SQLAlchemy, Pydantic, Alembic |
| **フロントエンド** | Vue.js (v3), Vite, TypeScript, Vuetify, Pinia, ApexCharts |
| **データベース**   | PostgreSQL                             |
| **インフラ**     | Docker, Docker Compose                 |
| **CI/CD**        | GitHub Actions                         |

---

## 🏁 セットアップ手順

Dockerがインストールされていれば、簡単なステップでローカル開発環境を起動できます。

### 1. リポジトリのクローン

```bash
git clone https://github.com/krtw00/duel-log-app.git
cd duel-log-app
```

### 2. 環境変数の設定

`.env.example` ファイルをコピーして `.env` ファイルを作成します。

```bash
cp .env.example .env
```

次に、`.env` ファイルを開き、`SECRET_KEY` の値を生成したものに置き換えてください。

**（Linux/macOSの場合）**
```bash
# ターミナルで以下のコマンドを実行し、生成された文字列をSECRET_KEYに設定
openssl rand -hex 32
```

**（Windowsの場合）**
PowerShellなどで以下のコマンドを実行するか、任意のランダムな文字列（32文字以上推奨）を設定してください。
```powershell
-join ((33..126) | Get-Random -Count 32 | ForEach-Object {[char]$_})
```

### 3. アプリケーションの起動

以下のコマンドを一度実行するだけで、必要なDockerイメージのビルド、コンテナの起動、データベースのマイグレーションが**すべて自動的に**行われます。

```bash
docker-compose up -d --build
```

### 4. アプリケーションへのアクセス

- **フロントエンド**: [http://localhost:5173](http://localhost:5173)
- **バックエンドAPIドキュメント (Swagger UI)**: [http://localhost:8000/docs](http://localhost:8000/docs)

---

## 🧪 テストとCI/CD

### テストの実行

- **バックエンド:**
  以下のコマンドで、バックエンドの単体・結合テストを実行できます。
  ```bash
  pytest backend/
  ```

- **フロントエンド:**
  現在テストは未実装ですが、`npm run build` を通じて型チェックが実行されます。

### CI (継続的インテグレーション)

このリポジトリでは、`main` ブランチへの `push` または `pull_request` をトリガーとして、GitHub Actionsによる自動テスト（バックエンド）とビルドチェック（フロントエンド）が実行されます。

---

## 🛡️ セキュリティ

本アプリケーションでは、認証情報の安全性を高めるため、以下のセキュリティ対策を実装しています。

- **HttpOnlyクッキー認証:**
  - 認証トークンは、JavaScriptからアクセスできない `HttpOnly` 属性を持つクッキーに保存されます。これにより、クロスサイトスクリプティング（XSS）攻撃によるトークン窃取のリスクを大幅に低減しています。
- **パスワードのハッシュ化:**
  - パスワードは `bcrypt` アルゴリズムを用いて安全にハッシュ化されてからデータベースに保存されます。

詳細は `docs/SECURITY_IMPROVEMENTS.md` を参照してください。